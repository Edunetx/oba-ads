<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OBA-ADS Signup</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<style>
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    background: linear-gradient(135deg, #000000, #434343, #ffffff);
    background-size: 400% 400%;
    animation: gradientAnim 10s ease infinite;
  }

  @keyframes gradientAnim {
    0%{background-position:0% 50%;}
    50%{background-position:100% 50%;}
    100%{background-position:0% 50%;}
  }

  .signup-container {
    background: rgba(0,0,0,0.85);
    padding: 30px;
    border-radius: 12px;
    width: 90%;
    max-width: 400px;
    color: white;
    box-shadow: 0 0 20px rgba(255,255,255,0.2);
    text-align: center;
  }

  h2 { margin-bottom: 20px; }

  input {
    width: 90%;
    padding: 12px;
    margin: 10px 0;
    border: none;
    border-radius: 6px;
    outline: none;
    transition: 0.3s;
    font-size: 16px;
  }

  input:focus {
    box-shadow: 0 0 8px #00f;
  }

  button {
    width: 95%;
    padding: 12px;
    margin-top: 10px;
    border: none;
    border-radius: 6px;
    background: #00f;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: 0.3s;
  }

  button:hover {
    background: #0055ff;
  }

  .notification {
    margin-top: 10px;
    padding: 10px;
    border-radius: 6px;
    background: #111;
    display: none;
  }

  .link-text {
    margin-top: 15px;
    font-size: 14px;
    color: #aaa;
  }

  .link-text a {
    color: #00f;
    text-decoration: none;
  }

  .link-text a:hover {
    text-decoration: underline;
  }
</style>
</head>
<body>

<div class="signup-container">
  <h2>OBA-ADS Signup</h2>
  <div class="notification" id="notification"></div>
  <input type="text" id="username" placeholder="Username" />
  <input type="email" id="email" placeholder="Email" />
  <input type="password" id="password" placeholder="Password (min 6 chars)" />
  <input type="text" id="referral" placeholder="Referral (optional)" />
  <button id="signupBtn">Sign Up</button>
  <div class="link-text">
    Already have an account? <a href="login.html">Login</a>
  </div>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAqcoCo_V68ILJReJ2WNDUhlMvoH_FbQn4",
    authDomain: "oba-ads.firebaseapp.com",
    projectId: "oba-ads",
    storageBucket: "oba-ads.firebasestorage.app",
    messagingSenderId: "801050707463",
    appId: "1:801050707463:web:6eb31025639431e197cca2"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  const notify = (msg, color="#00f") => {
    const n = document.getElementById("notification");
    n.style.display = "block";
    n.style.background = "#111";
    n.style.color = color;
    n.textContent = msg;
    setTimeout(() => { n.style.display = "none"; }, 4000);
  }

  document.getElementById("signupBtn").addEventListener("click", async () => {
    const username = document.getElementById("username").value.trim();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    let referral = document.getElementById("referral").value.trim();
    if (!username || !email || !password) return notify("Fill in all required fields!", "#f00");
    if (password.length < 6) return notify("Password must be at least 6 characters", "#f00");

    if (!referral) referral = "OBA"; // default referral

    try {
      // check username uniqueness
      const usernameSnap = await db.collection("users").where("username", "==", username).get();
      if (!usernameSnap.empty) return notify("Username is already taken", "#f00");

      // create auth
      const cred = await auth.createUserWithEmailAndPassword(email, password);

      // create user document
      await db.collection("users").doc(cred.user.uid).set({
        username,
        email,
        balance: 1, // signup bonus
        totalEarnings: 0,
        referral,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });

      notify("Account created successfully! You got $1 signup bonus.", "#0f0");

      // redirect after 2s
      setTimeout(() => { window.location.href = "login.html"; }, 2000);

    } catch (error) {
      notify(error.message, "#f00");
    }
  });
</script>

</body>
</html>
